(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{350:function(e,t){},353:function(e,t){},354:function(e,t){},358:function(e,t){},359:function(e,t){},385:function(e,t){},387:function(e,t){},400:function(e,t){},402:function(e,t){},417:function(e,t){},449:function(e,t){},450:function(e,t){},503:function(e,t){},505:function(e,t){},533:function(e,t){},535:function(e,t){},536:function(e,t){},541:function(e,t){},543:function(e,t){},549:function(e,t){},551:function(e,t){},570:function(e,t){},582:function(e,t){},585:function(e,t){},590:function(e,t){},613:function(e,t){},615:function(e,t){},621:function(e,t){},633:function(e,t){},636:function(e,t){},697:function(e,t){},728:function(e,t,n){"use strict";n.r(t);var i,r,a,c,u=n(0),o=n.n(u),s=n(318),p=n.n(s),l=n(15),y=n.n(l),m=n(23),d=n(328),b=n(178),f=n(62),j=n.n(f),h=new(n(329).a)({supportedChainIds:[4]}),v=n(5),x=n(7),w=[{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"lotteryId",type:"uint256"},{indexed:!1,internalType:"string",name:"name",type:"string"}],name:"NewLottery",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"lotteryId",type:"uint256"}],name:"NewTicketPurchase",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"lotteryId",type:"uint256"},{indexed:!1,internalType:"address",name:"winner",type:"address"}],name:"NewWinner",type:"event"},{inputs:[{internalType:"uint256",name:"_lotteryId",type:"uint256"}],name:"_getTotalPrize",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_lotteryId",type:"uint256"}],name:"buyTicket",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"string",name:"_name",type:"string"},{internalType:"uint256",name:"_size",type:"uint256"},{internalType:"uint256",name:"_ticketPrice",type:"uint256"},{internalType:"uint256",name:"_ownerCommission",type:"uint256"}],name:"createLottery",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"getBalance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getLotteries",outputs:[{components:[{internalType:"uint256",name:"id",type:"uint256"},{internalType:"string",name:"name",type:"string"},{internalType:"uint256",name:"size",type:"uint256"},{internalType:"uint256",name:"ticketPrice",type:"uint256"},{internalType:"uint256",name:"ticketHolderCount",type:"uint256"},{internalType:"bool",name:"completed",type:"bool"},{internalType:"address payable",name:"owner",type:"address"},{internalType:"uint256",name:"ownerCommission",type:"uint256"},{internalType:"address",name:"winner",type:"address"}],internalType:"struct LotteryFactory.Lottery[]",name:"",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_id",type:"uint256"}],name:"getLottery",outputs:[{components:[{internalType:"uint256",name:"id",type:"uint256"},{internalType:"string",name:"name",type:"string"},{internalType:"uint256",name:"size",type:"uint256"},{internalType:"uint256",name:"ticketPrice",type:"uint256"},{internalType:"uint256",name:"ticketHolderCount",type:"uint256"},{internalType:"bool",name:"completed",type:"bool"},{internalType:"address payable",name:"owner",type:"address"},{internalType:"uint256",name:"ownerCommission",type:"uint256"},{internalType:"address",name:"winner",type:"address"}],internalType:"struct LotteryFactory.Lottery",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_lotteryId",type:"uint256"}],name:"getTicketHolders",outputs:[{internalType:"address payable[]",name:"",type:"address[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"randomResult",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"requestId",type:"bytes32"},{internalType:"uint256",name:"randomness",type:"uint256"}],name:"rawFulfillRandomness",outputs:[],stateMutability:"nonpayable",type:"function"}],O=function(){function e(t){Object(v.a)(this,e),this.web3=new j.a(window.ethereum),this.contract=new this.web3.eth.Contract(w,"0x4F09a37dd7F93EaE7794CBd17b55c0101D1bF5eb"),this.account=t}return Object(x.a)(e,[{key:"getLotteries",value:function(){var e=Object(m.a)(y.a.mark((function e(){var t,n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.contract.methods.getLotteries().call();case 2:return t=e.sent,n=[],t.forEach((function(e){n.push({id:e.id,name:e.name,size:Number(e.size),ticketHolderCount:Number(e.ticketHolderCount),ticketPrice:Number(e.ticketPrice),owner:e.owner,ownerCommission:e.ownerCommission,completed:e.completed,winner:e.winner})})),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"buyTicket",value:function(){var e=Object(m.a)(y.a.mark((function e(t,n){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.contract.methods.buyTicket(t).send({from:this.account,value:n});case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createLottery",value:function(){var e=Object(m.a)(y.a.mark((function e(t,n,i,r){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.contract.methods.createLottery(t,n,j.a.utils.toWei(i.toString(),"ether"),r).send({from:this.account});case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,i,r){return e.apply(this,arguments)}}()}]),e}(),T=n(78),k=n(79),g=n(6),C=k.a.div(i||(i=Object(T.a)(["\n  padding: 5px;\n  padding-bottom: 10px;\n"]))),L=k.a.div(r||(r=Object(T.a)(["\n  display: flex;\n  flex-direction: row;\n"]))),z=function(e){var t=e.title,n=e.value;return Object(g.jsxs)(C,{children:[Object(g.jsx)("b",{children:t}),": ",n]})},N=function(e){var t=e.lottery,n=e.active,i=e.contract,r=function(){var e=Object(m.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.buyTicket(t.id,t.ticketPrice);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}(),a=t.name,c=t.size,u=t.ticketPrice,o=t.ticketHolderCount,s=t.ownerCommission,p=t.completed,l=t.winner;return Object(g.jsxs)(L,{children:[Object(g.jsx)(z,{title:"Name",value:a}),Object(g.jsx)(z,{title:"Size",value:"".concat(o,"/").concat(c)}),Object(g.jsx)(z,{title:"Price (Ether)",value:j.a.utils.fromWei(u.toString(),"ether")}),Object(g.jsx)(z,{title:"Owner Commission (%)",value:s}),Object(g.jsx)(z,{title:"Completed",value:p.toString()}),p&&Object(g.jsx)(z,{title:"Winner",value:l}),n&&!p?Object(g.jsx)("button",{onClick:r,children:"buy ticket"}):null]})},P=function(e){var t=e.lotteries,n=e.active,i=e.contract;return Object(g.jsxs)("div",{children:[Object(g.jsx)("h2",{children:"Lottery List"}),t.map((function(e){return Object(g.jsx)(N,{lottery:e,active:n,contract:i},e.id)}))]})},S=n(327),M=k.a.div(a||(a=Object(T.a)(["\n  display: flex;\n  flex-direction: row;\n  padding: 5px;\n  padding-bottom: 10px;\n"]))),I=k.a.div(c||(c=Object(T.a)(["\n  width: 100px;\n"]))),_=function(e){var t=e.contract,n=function(){var e=Object(m.a)(y.a.mark((function e(n,i){var r,a,c,u,o;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.name,a=n.size,c=n.price,u=n.ownerCommission,o=i.setSubmitting,e.prev=2,e.next=5,t.createLottery(r,a,c,u);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),console.log(e.t0);case 10:o(!1);case 11:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(t,n){return e.apply(this,arguments)}}();return Object(g.jsxs)("div",{children:[Object(g.jsx)("h2",{children:"Create New Lottery"}),Object(g.jsx)(S.a,{initialValues:{name:"",size:2,price:.5,ownerCommission:1},onSubmit:n,children:function(e){var t=e.values,n=e.errors,i=e.touched,r=e.handleChange,a=e.handleBlur,c=e.handleSubmit,u=e.isSubmitting;return Object(g.jsxs)("form",{onSubmit:c,children:[Object(g.jsxs)(M,{children:[Object(g.jsx)(I,{children:"Name:"}),Object(g.jsx)("input",{type:"text",name:"name",onChange:r,onBlur:a,value:t.name}),n.name&&i.name&&n.name]}),Object(g.jsxs)(M,{children:[Object(g.jsx)(I,{children:"Size:"}),Object(g.jsx)("input",{type:"number",name:"size",onChange:r,onBlur:a,value:t.size}),n.size&&i.size&&n.size]}),Object(g.jsxs)(M,{children:[Object(g.jsx)(I,{children:"Price (Ether):"}),Object(g.jsx)("input",{type:"number",name:"price",onChange:r,onBlur:a,value:t.price}),n.price&&i.price&&n.price]}),Object(g.jsxs)(M,{children:[Object(g.jsx)(I,{children:"Commission:"}),Object(g.jsx)("input",{type:"number",name:"ownerCommission",onChange:r,onBlur:a,value:t.ownerCommission}),n.ownerCommission&&i.ownerCommission&&n.ownerCommission]}),Object(g.jsx)("button",{type:"submit",disabled:u,children:"Submit"})]})}})]})};function B(e){return new j.a(e)}var E=function(){var e=Object(b.b)(),t=e.active,n=e.account,i=e.activate,r=Object(u.useState)([]),a=Object(d.a)(r,2),c=a[0],o=a[1],s=function(){var e=Object(m.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i(h);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}(),p=Object(u.useMemo)((function(){return new O(n)}),[n]),l=Object(u.useCallback)(Object(m.a)(y.a.mark((function e(){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return e.next=3,p.getLotteries();case 3:n=e.sent,o(n);case 5:case"end":return e.stop()}}),e)}))),[p,t]);return Object(u.useEffect)((function(){var e=function(){var e=Object(m.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[l,t]),Object(u.useEffect)((function(){var e=function(){var e=Object(m.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return t&&(p.contract.events.NewLottery().on("data",(function(t){e()})),p.contract.events.NewTicketPurchase().on("data",(function(t){e()})),p.contract.events.NewWinner().on("data",(function(t){e()}))),function(){p.contract.events.NewLottery().unsubscribe(),p.contract.events.NewTicketPurchase().unsubscribe(),p.contract.events.NewWinner().unsubscribe()}}),[n,t,p,l]),Object(g.jsxs)("div",{children:[Object(g.jsx)("button",{onClick:s,children:"Connect to Rinkeby"})," ",t?Object(g.jsxs)("span",{children:["Connected with: ",Object(g.jsx)("b",{children:n})]}):Object(g.jsx)("span",{children:"Not connected"}),Object(g.jsx)(P,{active:t,lotteries:c,contract:p}),t?Object(g.jsx)(_,{contract:p}):null]})},F=function(){return Object(g.jsx)(b.a,{getLibrary:B,children:Object(g.jsx)(E,{})})};p.a.render(Object(g.jsx)(o.a.StrictMode,{children:Object(g.jsx)(F,{})}),document.getElementById("root"))}},[[728,1,2]]]);
//# sourceMappingURL=main.fd0570e8.chunk.js.map